<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="fragment/head :: head"></th:block>
<th:block th:replace="fragment/header :: header"></th:block>
<body>
	<main class="page-row page-row-expanded">
	<nav th:replace="fragment/nav_bar :: nav_bar"></nav>

	<!-- BODY -->
	<div class="container-fluid">
		<div class="container-fluid">
			<div class="row">
				<div class="container">
					<div class="row">
						<div class="col-sm-12"></div>

						<!-- BREADCRUMP -->
						<ul class="breadcrumb">
							<th:block th:replace="fragment/breadcrumb :: breadcrumb"></th:block>
							<li class="active">Signature validation</li>
							<li class="active">Results</li>
						</ul>

						<!-- CONTENT -->
						<div class="row">
							<th:block th:replace="fragment/menu :: menu"></th:block>
							<div class="col-md-9">
								<ul class="nav nav-tabs nav-justified hidden-print"	id="tabsResult" style="margin-top: 25px;">
									<li role="presentation" class="active"><a href="#simple-report" th:text="#{label.simple.report}"></a></li>
									<li role="presentation"><a href="#detailed-report" th:text="#{label.detailed.report}"></a></li>
									<li role="presentation"><a href="#diagnostic-tree" th:text="#{label.diagnostic.tree}"></a></li>
								</ul>

								<div class="tab-content" style="margin-top: 10px">

									<div role="tabpanel" class="tab-pane fade in active" id="simple-report">
										<div class="btn-group pull-right hidden-print" role="toolbar" style="margin: 4px;">
											<button type="button" class="btn btn-default" onclick="window.print();">
												<span class="glyphicon glyphicon-print"></span> Print
											</button>
											<a class="btn btn-default" th:href="@{/validation/download-simple-report}" role="button" th:if="${displayDownloadPdf}"> 
												<span class="glyphicon glyphicon-save-file"></span> Download as	PDF
											</a>
										</div>

										<div th:utext="${simpleReport}"></div>
									</div>
									<div role="tabpanel" class="tab-pane fade" id="detailed-report">
										<div class="btn-group pull-right hidden-print" role="toolbar" style="margin: 4px;">
											<button type="button" class="btn btn-default" onclick="window.print();">
												<span class="glyphicon glyphicon-print"></span> Print
											</button>
											<a class="btn btn-default" th:href="@{/validation/download-detailed-report}" role="button" th:if="${displayDownloadPdf}"> 
												<span class="glyphicon glyphicon-save-file"></span> Download as	PDF
											</a>
										</div>

										<div th:utext="${detailedReport}"></div>
									</div>
									<div role="tabpanel" class="tab-pane fade" id="diagnostic-tree">
										<div class="panel panel-default">
		                                    <div class="panel-heading collapsed" data-toggle="collapse" data-target="#downloads" aria-expanded='false' >
		                                        <h3 class="panel-title" th:text="#{label.validation.download}"></h3>
		                                    </div>
		                                    
		                                    <div class="panel-body collapse in" id="downloads">
		                                        <!-- Certificates -->
		                                        <div class="row" th:if="${usedCertificates != null && usedCertificates.size() > 0}">
													<label class="col-sm-2 control-label" th:text="#{label.validation.certificates.used}"></label>
												   	<div class="col-sm-7">
												    	<table><tr th:each="uc : ${usedCertificates}"><td>
											       			<a th:href="@{|/${validationTile}/download-certificate?id=${uc.getId()}|}">
											       				<span th:text="${uc.getCommonName()}"></span>
											       			</a>
										       				<div th:if="${showRevocation && uc.isRevocationDataAvailable()}" style="display: inline;">
										       					<span> - </span>
										       					<div th:each="rd : ${uc.getRevocationData()}" style="display: inline;">
										       						<span th:text="${#strings.replace(rd.getSource(), 'Token', '')}"></span>
										       						<div th:replace="fields :: field-der-pem(${#strings.contains(rd.getSource(), 'CRL')}, |/${validationTile}/download-revocation?id=${rd.getId()}|)"></div>
										       					</div>
										       				</div>
												       	</td></tr></table>
													</div>
												</div>
		                                        <!-- Timestamps -->
		                                        <div class="row" th:if="${allTimestamps != null && allTimestamps.size() > 0}">
													<label class="col-sm-2 control-label" th:text="#{label.validation.timestamps}"></label>
												   	<div class="col-sm-7">
												    	<table><tr th:each="tst : ${allTimestamps}"><td>
											       			<span th:text="${tst.getType()}"></span>
											       			<div th:replace="fields :: field-der-pem(true, |/${validationTile}/download-timestamp?id=${tst.getId()}|)"></div>
											       		</td></tr></table>
													</div>
												</div>
		                                    </div>
		                                </div>
										<pre class="prettyprint lang-xml" th:text="${diagnosticTree}"></pre>
									</div>
								</div>

								<script type="text/javascript">
									$('#tabsResult a').click(function(e) {
										e.preventDefault()
										$(this).tab('show')
									});

									$('[data-toggle="tooltip"]').tooltip();
								</script>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
	</main>
	<th:block th:replace="fragment/footer :: footer"></th:block>
</body>
</html>